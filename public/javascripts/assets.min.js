"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;const t=exports.Emile,s=exports.assetCategories;delete exports.assetCategories;let o=exports.assets;delete exports.assets;const a=document.querySelector("#filter--categoryId"),n=document.querySelector("#filter--assets");function r(e){e.preventDefault(),cityssm.postJSON(t.urlPrefix+"/assets/doUpdateAsset",e.currentTarget,e=>{var t;const s=e;s.success?(o=s.assets,bulmaJS.alert({message:"Asset updated successfully.",contextualColorName:"success"}),i()):bulmaJS.alert({title:"Error Updating Asset",message:null!==(t=s.errorMessage)&&void 0!==t?t:"Please try again.",contextualColorName:"danger"})})}function l(e){let a;function n(s){s.preventDefault(),bulmaJS.confirm({title:"Delete Asset",message:"Are you sure you want to delete this asset?",contextualColorName:"warning",okButton:{text:"Yes, Delete Asset",callbackFunction:function(){cityssm.postJSON(t.urlPrefix+"/assets/doDeleteAsset",{assetId:e},e=>{var t;const s=e;s.success?(o=s.assets,i(),a()):bulmaJS.alert({title:"Error Deleting Asset",message:null!==(t=s.errorMessage)&&void 0!==t?t:"",contextualColorName:"danger"})})}}})}cityssm.openHtmlModal("asset-view",{onshow(o){!function(e,o){cityssm.postJSON(t.urlPrefix+"/assets/doGetAsset",{assetId:o},o=>{var a,n,r,l,d,i,c;const u=o;if(!u.success)return void bulmaJS.alert({title:"Error Loading Asset Details",message:"Please refresh the page and try again.",contextualColorName:"danger"});e.querySelector("#assetView--assetId").value=null!==(n=null===(a=u.asset.assetId)||void 0===a?void 0:a.toString())&&void 0!==n?n:"",e.querySelector('.modal-card-head [data-field="assetName"]').textContent=u.asset.assetName;const m=e.querySelector("#assetView--categoryId");let g=!1;if(t.canUpdate)for(const e of s){const t=document.createElement("option");t.value=null!==(l=null===(r=e.categoryId)||void 0===r?void 0:r.toString())&&void 0!==l?l:"",t.textContent=e.category,e.categoryId===u.asset.categoryId&&(t.selected=!0,g=!0),m.append(t)}if(!g){const e=document.createElement("option");e.value=null!==(i=null===(d=u.asset.categoryId)||void 0===d?void 0:d.toString())&&void 0!==i?i:"",e.textContent=null!==(c=u.asset.category)&&void 0!==c?c:"",e.selected=!0,m.append(e)}e.querySelector("#assetView--assetName").value=u.asset.assetName})}(o,e),t.canUpdate&&(o.querySelector("#form--assetView fieldset").disabled=!1)},onshown(e,s){var o,l;bulmaJS.toggleHtmlClipped(),bulmaJS.init(e),t.canUpdate&&(a=s,null===(o=e.querySelector("#form--assetView"))||void 0===o||o.addEventListener("submit",r),null===(l=e.querySelector(".is-delete-button"))||void 0===l||l.addEventListener("click",n))},onremoved(){bulmaJS.toggleHtmlClipped()}})}function d(e){var t,s;e.preventDefault(),l(null!==(s=null===(t=e.currentTarget.closest("tr"))||void 0===t?void 0:t.dataset.assetId)&&void 0!==s?s:"")}function i(){var e,t,s,r,l,i;document.querySelector("#count--assets").textContent=o.length.toString();const c=document.querySelector("#container--assets");if(0===o.length)return void(c.innerHTML='<div class="message is-warning">\n        <p class="message-body">\n          <strong>No Assets Found</strong><br />\n          Get started by adding some assets that will be reported on.\n        </p>\n        </div>');const u=n.value.trim().toLowerCase().split(" "),m=document.createElement("table");m.className="table is-fullwidth is-striped has-sticky-header",m.innerHTML='<thead><tr>\n      <th class="has-width-10"></th>\n      <th>Category</th>\n      <th>Asset</th>\n      </tr></thead>\n      <tbody></tbody>';e:for(const n of o){if(""!==a.value&&a.value!==(null===(e=n.categoryId)||void 0===e?void 0:e.toString()))continue;const o=n.assetName.toLowerCase()+" "+(null!==(t=n.category)&&void 0!==t?t:"").toLowerCase();for(const e of u)if(!o.includes(e))continue e;const c=document.createElement("tr");c.dataset.assetId=null!==(r=null===(s=n.assetId)||void 0===s?void 0:s.toString())&&void 0!==r?r:"",c.innerHTML=`<td class="has-width-10 has-text-centered">\n        <i class="${null!==(l=n.fontAwesomeIconClasses)&&void 0!==l?l:"fas fa-bolt"}" aria-hidden="true"></i>\n        </td>\n        <td data-field="category"></td>\n        <td><a data-field="assetName" href="#"></a></td>`,c.querySelector('[data-field="category"]').textContent=null!==(i=n.category)&&void 0!==i?i:"";const g=c.querySelector('[data-field="assetName"]');g.textContent=n.assetName,g.addEventListener("click",d),m.querySelector("tbody").append(c)}0===m.querySelectorAll("tbody tr").length?c.innerHTML='<div class="message is-info">\n        <p class="message-body">\n          <strong>There are no assets that meet your search criteria.</strong><br />\n          Try to be less specific in your search. \n        </p>\n        </div>':(c.innerHTML="",c.append(m))}null===(e=document.querySelector("#button--addAsset"))||void 0===e||e.addEventListener("click",()=>{let e;function a(s){s.preventDefault(),cityssm.postJSON(t.urlPrefix+"/assets/doAddAsset",s.currentTarget,t=>{const s=t;s.success&&(o=s.assets,i(),e())})}cityssm.openHtmlModal("asset-add",{onshow(e){var t,o;const a=e.querySelector("#assetAdd--categoryId");for(const e of s){const s=document.createElement("option");s.value=null!==(o=null===(t=e.categoryId)||void 0===t?void 0:t.toString())&&void 0!==o?o:"",s.textContent=e.category,a.append(s)}},onshown(t,s){var o;e=s,bulmaJS.toggleHtmlClipped(),null===(o=t.querySelector("form"))||void 0===o||o.addEventListener("submit",a)},onremoved(){bulmaJS.toggleHtmlClipped()}})});exports.assetGroups;delete exports.assetGroups,bulmaJS.init(),n.addEventListener("keyup",i),a.addEventListener("change",i),i()})();