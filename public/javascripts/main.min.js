"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;const t=document.querySelector("main"),s=null!==(e=t.dataset.urlPrefix)&&void 0!==e?e:"",a="true"===t.dataset.canUpdate;let n=!1;function o(){return n}const l={urlPrefix:s,canUpdate:a,getMapLink:function(e,t){return`https://www.google.com/maps/search/?api=1&query=${e},${t}`},initializeAssetSelector:function(e){var t,s,a;let n,o,r,i,c;const u=e.assetSelectorElement.querySelector(".icon"),d=e.assetSelectorElement.querySelector("button"),p=e.assetSelectorElement.querySelector('input[name="assetId"]'),v=null!==p,m=e.assetSelectorElement.querySelector('input[name="groupId"]'),f=null!==m;let g=null!==(t=d.dataset.noSelectionText)&&void 0!==t?t:"";function S(t){var s,a,o,r;t.preventDefault();const i=Number.parseInt(null!==(s=t.currentTarget.dataset.assetId)&&void 0!==s?s:"",10),c=l.assets.find(e=>e.assetId===i);f&&(m.value=""),p.value=null!==(o=null===(a=c.assetId)||void 0===a?void 0:a.toString())&&void 0!==o?o:"",u.innerHTML=`<i class="${null!==(r=c.fontAwesomeIconClasses)&&void 0!==r?r:"fas fa-bolt"}" aria-hidden="true"></i>`,d.textContent=c.assetName,n(),void 0!==e.callbackFunction&&e.callbackFunction({type:"asset",assetId:i})}function y(){var e,t,s,a;const n=document.createElement("div");n.className="panel";const i=o.value.trim().toLowerCase().split(" ");e:for(const o of l.assets){const l=`${o.assetName} ${null!==(e=o.category)&&void 0!==e?e:""}`.toLowerCase();for(const e of i)if(!l.includes(e))continue e;const r=document.createElement("a");r.className="panel-block is-block",r.href="#",r.dataset.assetId=null===(t=o.assetId)||void 0===t?void 0:t.toString(),r.innerHTML=`<strong data-field="assetName"></strong><br />\n          <i class="${null!==(s=o.fontAwesomeIconClasses)&&void 0!==s?s:"fas fa-bolt"}" aria-hidden="true"></i> <span class="is-size-7" data-field="category"></span>`,r.querySelector('[data-field="category"]').textContent=null!==(a=o.category)&&void 0!==a?a:"",r.querySelector('[data-field="assetName"]').textContent=o.assetName,r.addEventListener("click",S),n.append(r)}n.hasChildNodes()?(r.innerHTML="",r.append(n)):r.innerHTML='<div class="message is-info">\n          <p class="message-body">\n            There are no assets that meet your search criteria.\n          </p>\n          </div>'}function b(t){var s,a,o;t.preventDefault();const r=Number.parseInt(null!==(s=t.currentTarget.dataset.groupId)&&void 0!==s?s:"",10),i=l.assetGroups.find(e=>e.groupId===r);v&&(p.value=""),m.value=null!==(o=null===(a=i.groupId)||void 0===a?void 0:a.toString())&&void 0!==o?o:"",u.innerHTML='<i class="fas fa-city" aria-hidden="true"></i>',d.textContent=i.groupName,n(),void 0!==e.callbackFunction&&e.callbackFunction({type:"assetGroup",groupId:r})}function h(){var e,t,s;const a=document.createElement("div");a.className="panel";const n=i.value.trim().toLowerCase().split(" ");e:for(const o of l.assetGroups){const l=`${o.groupName} ${null!==(e=o.groupDescription)&&void 0!==e?e:""}`.toLowerCase();for(const e of n)if(!l.includes(e))continue e;const r=document.createElement("a");r.className="panel-block is-block",r.href="#",r.dataset.groupId=null===(t=o.groupId)||void 0===t?void 0:t.toString(),r.innerHTML='<i class="fas fa-city" aria-hidden="true"></i>\n          <strong data-field="groupName"></strong><br />\n          <span class="is-size-7" data-field="groupDescription"></span>',r.querySelector('[data-field="groupName"]').textContent=null!==(s=o.groupName)&&void 0!==s?s:"",r.querySelector('[data-field="groupDescription"]').textContent=o.groupDescription,r.addEventListener("click",b),a.append(r)}a.hasChildNodes()?(c.innerHTML="",c.append(a)):c.innerHTML='<div class="message is-info">\n          <p class="message-body">\n            There are no asset groups that meet your search criteria.\n          </p>\n          </div>'}""!==g||null!==p&&""!==p.value||null!==m&&""!==m.value||(g=null!==(s=d.textContent)&&void 0!==s?s:""),""===g&&f&&(g="(Select Assets)"),""===g&&(g="(Select Asset)"),null==d||d.addEventListener("click",()=>{cityssm.openHtmlModal("asset-select",{onshow(e){var t,s,a;o=e.querySelector("#assetSelector--assetFilter"),r=e.querySelector("#assetSelectorContainer--assets"),i=e.querySelector("#assetSelector--assetGroupFilter"),c=e.querySelector("#assetSelectorContainer--assetGroups"),v&&f?bulmaJS.init(e):null===(t=e.querySelector(".tabs"))||void 0===t||t.remove(),v||(null===(s=e.querySelector("#assetSelectorTab--assets"))||void 0===s||s.remove(),null===(a=e.querySelector("#assetSelectorTab--assetGroups"))||void 0===a||a.classList.remove("is-hidden"),e.querySelector(".modal-card-title").textContent="Select an Asset Group")},onshown(e,t){n=t,bulmaJS.toggleHtmlClipped(),bulmaJS.init(e),v&&(y(),o.addEventListener("keyup",y)),f&&(h(),i.addEventListener("keyup",h))},onremoved(){bulmaJS.toggleHtmlClipped()}})}),null===(a=e.assetSelectorElement.querySelector(".is-clear-button"))||void 0===a||a.addEventListener("click",()=>{v&&(p.value=""),f&&(m.value=""),u.innerHTML='<i class="fas fa-bolt" aria-hidden="true"></i>',d.textContent=g,void 0!==e.callbackFunction&&e.callbackFunction({type:"clear"})})},assets:[],assetGroups:[],assetCategories:[],setUnsavedChanges:function(){o()||(n=!0,cityssm.enableNavBlocker())},clearUnsavedChanges:function(){n=!1,cityssm.disableNavBlocker()},hasUnsavedChanges:o};exports.Emile=l})();