"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;const t=document.querySelector("main"),s=null!==(e=t.dataset.urlPrefix)&&void 0!==e?e:"",a="true"===t.dataset.canUpdate;let n=!1;function o(){return n}const r={urlPrefix:s,canUpdate:a,getMapLink:function(e,t){return`https://www.google.com/maps/search/?api=1&query=${e},${t}`},initializeAssetSelector:function(e){let t,s,a,n,o;const l=e.assetSelectorElement.querySelector(".icon"),i=e.assetSelectorElement.querySelector("button"),c=e.assetSelectorElement.querySelector('input[name="assetId"]'),u=null!==c,d=e.assetSelectorElement.querySelector('input[name="groupId"]'),p=null!==d;function m(s){var a,n,o,u;s.preventDefault();const m=Number.parseInt(null!==(a=s.currentTarget.dataset.assetId)&&void 0!==a?a:"",10),v=r.assets.find(e=>e.assetId===m);p&&(d.value=""),c.value=null!==(o=null===(n=v.assetId)||void 0===n?void 0:n.toString())&&void 0!==o?o:"",l.innerHTML=`<i class="${null!==(u=v.fontAwesomeIconClasses)&&void 0!==u?u:"fas fa-bolt"}" aria-hidden="true"></i>`,i.textContent=v.assetName,t(),void 0!==e.callbackFunction&&e.callbackFunction({type:"asset",assetId:m})}function v(){var e,t,n,o;const l=document.createElement("div");l.className="panel";const i=s.value.trim().toLowerCase().split(" ");e:for(const s of r.assets){const a=`${s.assetName} ${null!==(e=s.category)&&void 0!==e?e:""}`.toLowerCase();for(const e of i)if(!a.includes(e))continue e;const r=document.createElement("a");r.className="panel-block is-block",r.href="#",r.dataset.assetId=null===(t=s.assetId)||void 0===t?void 0:t.toString(),r.innerHTML=`<strong data-field="assetName"></strong><br />\n          <i class="${null!==(n=s.fontAwesomeIconClasses)&&void 0!==n?n:"fas fa-bolt"}" aria-hidden="true"></i> <span class="is-size-7" data-field="category"></span>`,r.querySelector('[data-field="category"]').textContent=null!==(o=s.category)&&void 0!==o?o:"",r.querySelector('[data-field="assetName"]').textContent=s.assetName,r.addEventListener("click",m),l.append(r)}l.hasChildNodes()?(a.innerHTML="",a.append(l)):a.innerHTML='<div class="message is-info">\n          <p class="message-body">\n            There are no assets that meet your search criteria.\n          </p>\n          </div>'}function f(s){var a,n,o;s.preventDefault();const p=Number.parseInt(null!==(a=s.currentTarget.dataset.groupId)&&void 0!==a?a:"",10),m=r.assetGroups.find(e=>e.groupId===p);u&&(c.value=""),d.value=null!==(o=null===(n=m.groupId)||void 0===n?void 0:n.toString())&&void 0!==o?o:"",l.innerHTML='<i class="fas fa-city" aria-hidden="true"></i>',i.textContent=m.groupName,t(),void 0!==e.callbackFunction&&e.callbackFunction({type:"assetGroup",groupId:p})}function g(){var e,t,s;const a=document.createElement("div");a.className="panel";const l=n.value.trim().toLowerCase().split(" ");e:for(const n of r.assetGroups){const o=`${n.groupName} ${null!==(e=n.groupDescription)&&void 0!==e?e:""}`.toLowerCase();for(const e of l)if(!o.includes(e))continue e;const r=document.createElement("a");r.className="panel-block is-block",r.href="#",r.dataset.groupId=null===(t=n.groupId)||void 0===t?void 0:t.toString(),r.innerHTML='<i class="fas fa-city" aria-hidden="true"></i>\n          <strong data-field="groupName"></strong><br />\n          <span class="is-size-7" data-field="groupDescription"></span>',r.querySelector('[data-field="groupName"]').textContent=null!==(s=n.groupName)&&void 0!==s?s:"",r.querySelector('[data-field="groupDescription"]').textContent=n.groupDescription,r.addEventListener("click",f),a.append(r)}a.hasChildNodes()?(o.innerHTML="",o.append(a)):o.innerHTML='<div class="message is-info">\n          <p class="message-body">\n            There are no asset groups that meet your search criteria.\n          </p>\n          </div>'}null==i||i.addEventListener("click",()=>{cityssm.openHtmlModal("asset-select",{onshow(e){var t,r,l;s=e.querySelector("#assetSelector--assetFilter"),a=e.querySelector("#assetSelectorContainer--assets"),n=e.querySelector("#assetSelector--assetGroupFilter"),o=e.querySelector("#assetSelectorContainer--assetGroups"),u&&p?bulmaJS.init(e):null===(t=e.querySelector(".tabs"))||void 0===t||t.remove(),u||(null===(r=e.querySelector("#assetSelectorTab--assets"))||void 0===r||r.remove(),null===(l=e.querySelector("#assetSelectorTab--assetGroups"))||void 0===l||l.classList.remove("is-hidden"),e.querySelector(".modal-card-title").textContent="Select an Asset Group")},onshown(e,a){t=a,bulmaJS.toggleHtmlClipped(),bulmaJS.init(e),u&&(v(),s.addEventListener("keyup",v)),p&&(g(),n.addEventListener("keyup",g))},onremoved(){bulmaJS.toggleHtmlClipped()}})})},assets:[],assetGroups:[],assetCategories:[],setUnsavedChanges:function(){o()||(n=!0,cityssm.enableNavBlocker())},clearUnsavedChanges:function(){n=!1,cityssm.disableNavBlocker()},hasUnsavedChanges:o};exports.Emile=r})();