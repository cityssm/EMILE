"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;const t=document.querySelector("main"),s=null!==(e=t.dataset.urlPrefix)&&void 0!==e?e:"",a="true"===t.dataset.canUpdate;let o=!1;function n(){return o}const l={urlPrefix:s,canUpdate:a,getMapLink:function(e,t){return`https://www.google.com/maps/search/?api=1&query=${e},${t}`},initializeAssetSelector:function(e){var t,s,a;let o,n,r,i,c,d,u;const v=e.assetSelectorElement.querySelector(".icon"),p=e.assetSelectorElement.querySelector("button"),m=e.assetSelectorElement.querySelector('input[name="assetId"]'),g=null!==m,f=e.assetSelectorElement.querySelector('input[name="categoryId"]'),y=null!==f,S=e.assetSelectorElement.querySelector('input[name="groupId"]'),b=null!==S;let C=null!==(t=p.dataset.noSelectionText)&&void 0!==t?t:"";function h(t){var s,a,n,r;t.preventDefault();const i=Number.parseInt(null!==(s=t.currentTarget.dataset.assetId)&&void 0!==s?s:"",10),c=l.assets.find(e=>e.assetId===i);y&&(f.value=""),b&&(S.value=""),m.value=null!==(n=null===(a=c.assetId)||void 0===a?void 0:a.toString())&&void 0!==n?n:"",v.innerHTML=`<i class="${null!==(r=c.fontAwesomeIconClasses)&&void 0!==r?r:"fas fa-bolt"}" aria-hidden="true"></i>`,p.textContent=c.assetName,o(),void 0!==e.callbackFunction&&e.callbackFunction({type:"asset",assetId:i})}function L(){var e,t,s,a;const o=document.createElement("div");o.className="panel";const i=n.value.trim().toLowerCase().split(" ");e:for(const n of l.assets){const l=`${n.assetName} ${null!==(e=n.category)&&void 0!==e?e:""}`.toLowerCase();for(const e of i)if(!l.includes(e))continue e;const r=document.createElement("a");r.className="panel-block is-block",r.href="#",r.dataset.assetId=null===(t=n.assetId)||void 0===t?void 0:t.toString(),r.innerHTML=`<strong data-field="assetName"></strong><br />\n          <i class="${null!==(s=n.fontAwesomeIconClasses)&&void 0!==s?s:"fas fa-bolt"}" aria-hidden="true"></i> <span class="is-size-7" data-field="category"></span>`,r.querySelector('[data-field="category"]').textContent=null!==(a=n.category)&&void 0!==a?a:"",r.querySelector('[data-field="assetName"]').textContent=n.assetName,r.addEventListener("click",h),o.append(r)}o.hasChildNodes()?(r.innerHTML="",r.append(o)):r.innerHTML='<div class="message is-info">\n          <p class="message-body">\n            There are no assets that meet your search criteria.\n          </p>\n          </div>'}function I(t){var s,a,n,r;t.preventDefault();const i=Number.parseInt(null!==(s=t.currentTarget.dataset.categoryId)&&void 0!==s?s:"",10),c=l.assetCategories.find(e=>e.categoryId===i);g&&(m.value=""),b&&(S.value=""),f.value=null!==(n=null===(a=c.categoryId)||void 0===a?void 0:a.toString())&&void 0!==n?n:"",v.innerHTML=`<i class="${null!==(r=c.fontAwesomeIconClasses)&&void 0!==r?r:"fas fa-bolt"}" aria-hidden="true"></i>`,p.textContent=c.category,o(),void 0!==e.callbackFunction&&e.callbackFunction({type:"assetCategory",categoryId:i})}function k(){var e,t,s;const a=document.createElement("div");a.className="panel";const o=i.value.trim().toLowerCase().split(" ");e:for(const n of l.assetCategories){const l=n.category.toLowerCase();for(const e of o)if(!l.includes(e))continue e;const r=document.createElement("a");r.className="panel-block is-block",r.href="#",r.dataset.categoryId=null===(e=n.categoryId)||void 0===e?void 0:e.toString(),r.innerHTML=`<span class="icon"><i class="${null!==(t=n.fontAwesomeIconClasses)&&void 0!==t?t:"fas fa-bolt"}" aria-hidden="true"></i></span>\n          <strong data-field="category"></strong>`,r.querySelector('[data-field="category"]').textContent=null!==(s=n.category)&&void 0!==s?s:"",r.addEventListener("click",I),a.append(r)}a.hasChildNodes()?(c.innerHTML="",c.append(a)):c.innerHTML='<div class="message is-info">\n          <p class="message-body">\n            There are no asset categories that meet your search criteria.\n          </p>\n          </div>'}function q(t){var s,a,n;t.preventDefault();const r=Number.parseInt(null!==(s=t.currentTarget.dataset.groupId)&&void 0!==s?s:"",10),i=l.assetGroups.find(e=>e.groupId===r);g&&(m.value=""),y&&(f.value=""),S.value=null!==(n=null===(a=i.groupId)||void 0===a?void 0:a.toString())&&void 0!==n?n:"",v.innerHTML='<i class="fas fa-city" aria-hidden="true"></i>',p.textContent=i.groupName,o(),void 0!==e.callbackFunction&&e.callbackFunction({type:"assetGroup",groupId:r})}function N(){var e,t,s;const a=document.createElement("div");a.className="panel";const o=d.value.trim().toLowerCase().split(" ");e:for(const n of l.assetGroups){const l=`${n.groupName} ${null!==(e=n.groupDescription)&&void 0!==e?e:""}`.toLowerCase();for(const e of o)if(!l.includes(e))continue e;const r=document.createElement("a");r.className="panel-block is-block",r.href="#",r.dataset.groupId=null===(t=n.groupId)||void 0===t?void 0:t.toString(),r.innerHTML='<span class="icon"><i class="fas fa-city" aria-hidden="true"></i></span>\n          <strong data-field="groupName"></strong><br />\n          <span class="is-size-7" data-field="groupDescription"></span>',r.querySelector('[data-field="groupName"]').textContent=null!==(s=n.groupName)&&void 0!==s?s:"",r.querySelector('[data-field="groupDescription"]').textContent=n.groupDescription,r.addEventListener("click",q),a.append(r)}a.hasChildNodes()?(u.innerHTML="",u.append(a)):u.innerHTML='<div class="message is-info">\n          <p class="message-body">\n            There are no asset groups that meet your search criteria.\n          </p>\n          </div>'}""!==C||null!==m&&""!==m.value||null!==f&&""!==f.value||null!==S&&""!==S.value||(C=null!==(s=p.textContent)&&void 0!==s?s:""),""===C&&(y||b)&&(C="(Select Assets)"),""===C&&(C="(Select Asset)"),null==p||p.addEventListener("click",()=>{cityssm.openHtmlModal("asset-select",{onshow(e){var t,s,a,o,l,v,p,m,f;n=e.querySelector("#assetSelector--assetFilter"),r=e.querySelector("#assetSelectorContainer--assets"),i=e.querySelector("#assetSelector--assetCategoryFilter"),c=e.querySelector("#assetSelectorContainer--assetCategories"),d=e.querySelector("#assetSelector--assetGroupFilter"),u=e.querySelector("#assetSelectorContainer--assetGroups"),y||(console.log("remove tab"),null===(s=null===(t=e.querySelector('.tabs a[href$="--assetCategories"]'))||void 0===t?void 0:t.closest("li"))||void 0===s||s.remove()),b||null===(o=null===(a=e.querySelector('.tabs a[href$="--assetGroups"]'))||void 0===a?void 0:a.closest("li"))||void 0===o||o.remove(),g||(null===(v=null===(l=e.querySelector('.tabs a[href$="--assets"]'))||void 0===l?void 0:l.closest("li"))||void 0===v||v.remove(),null===(m=null===(p=e.querySelector(`a[aria-controls='assetSelectorTab--${y?"assetCategories":"assetGroups"}']`))||void 0===p?void 0:p.closest("li"))||void 0===m||m.classList.add("is-hidden"),null===(f=e.querySelector(`#assetSelectorTab--${y?"assetCategories":"assetGroups"}`))||void 0===f||f.classList.remove("is-hidden"),e.querySelector(".modal-card-title").textContent="Select Assets")},onshown(e,t){o=t,bulmaJS.toggleHtmlClipped(),bulmaJS.init(e),g&&(L(),n.addEventListener("keyup",L)),y&&(k(),i.addEventListener("keyup",k)),b&&(N(),d.addEventListener("keyup",N))},onremoved(){bulmaJS.toggleHtmlClipped()}})}),null===(a=e.assetSelectorElement.querySelector(".is-clear-button"))||void 0===a||a.addEventListener("click",()=>{g&&(m.value=""),y&&(f.value=""),b&&(S.value=""),v.innerHTML='<i class="fas fa-bolt" aria-hidden="true"></i>',p.textContent=C,void 0!==e.callbackFunction&&e.callbackFunction({type:"clear"})})},assets:[],assetGroups:[],assetCategories:[],setUnsavedChanges:function(){n()||(o=!0,cityssm.enableNavBlocker())},clearUnsavedChanges:function(){o=!1,cityssm.disableNavBlocker()},hasUnsavedChanges:n};exports.Emile=l})();