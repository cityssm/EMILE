"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;const s=exports.Emile,n=exports.userDomain,t="fa-check has-text-success",a="fa-times has-text-danger";let i=exports.users;function l(e){var n,i,l;const o=e.currentTarget,d=o.value,r=null!==(n=o.dataset.action)&&void 0!==n?n:"",c=null!==(l=null===(i=o.closest("tr"))||void 0===i?void 0:i.dataset.userName)&&void 0!==l?l:"";cityssm.postJSON(`${s.urlPrefix}/admin/${r}`,{userName:c,permissionValue:d},e=>{var s;e.success?(null===(s=o.closest(".field"))||void 0===s?void 0:s.querySelector(".icon")).innerHTML=`<i class="fas ${"1"===d?t:a}" aria-hidden="true"></i>`:(bulmaJS.alert({title:"Error Updating User Permission",message:"Please try again.",contextualColorName:"danger"}),o.value="1"===o.value?"0":"1")})}function o(e){var n,t;const a=null!==(t=null===(n=e.currentTarget.closest("tr"))||void 0===n?void 0:n.dataset.userName)&&void 0!==t?t:"";bulmaJS.confirm({title:"Delete User",message:`Are you sure you want to delete "${a}"?`,contextualColorName:"warning",okButton:{text:"Yes, Delete User",callbackFunction:function(){cityssm.postJSON(`${s.urlPrefix}/admin/doDeleteUser`,{userName:a},e=>{const s=e;s.success?(i=s.users,bulmaJS.alert({message:"User deleted successfully.",contextualColorName:"success"}),d()):bulmaJS.alert({title:"Error Deleting User",message:"Please try again.",contextualColorName:"danger"})})}}})}function d(){var e,s;const n=document.querySelector("#container--users");if(0===i.length)return void(n.innerHTML='<div class="message is-warning">\n        <p class="message-body">\n          <strong>There are no active users available.</strong>\n        </p>\n        </div>');n.innerHTML='<table class="table is-fullwidth is-striped is-hoverable has-sticky-header">\n      <thead>\n        <tr>\n          <th>User Name</th>\n          <th class="has-text-centered">Can Login</th>\n          <th class="has-text-centered">Can Update</th>\n          <th class="has-text-centered">Is Admin</th>\n          <th class="has-width-10">\n            <span class="is-sr-only">Options</span>\n          </th>\n        </tr>\n      </thead>\n      <tbody></tbody>\n      </table>';for(const l of i){const i=document.createElement("tr");i.dataset.userName=l.userName,i.innerHTML=`<td class="is-vcentered">${l.userName}</td>\n        <td>\n          <div class="field has-addons">\n            <div class="control">\n              <span class="button is-static">\n              <span class="icon">\n                <i class="fas ${l.canLogin?t:a}" aria-hidden="true"></i>\n              </span>\n              </span>\n            </div>\n            <div class="control is-expanded">\n              <div class="select is-fullwidth">\n                <select data-action="doUpdateUserCanLogin">\n                  <option value="0">Access Denied</option>\n                  <option value="1" ${l.canLogin?" selected":""}>Yes, Can Log In</option>\n                </select>\n              </div>\n            </div>\n          </div>\n        </td>\n        <td>\n          <div class="field has-addons">\n            <div class="control">\n              <span class="button is-static">\n              <span class="icon">\n                <i class="fas ${l.canUpdate?t:a}" aria-hidden="true"></i>\n              </span>\n              </span>\n            </div>\n            <div class="control is-expanded">\n              <div class="select is-fullwidth">\n                <select data-action="doUpdateUserCanUpdate">\n                  <option value="0">Read Only</option>\n                  <option value="1" ${l.canUpdate?" selected":""}>Yes, Can Update</option>\n                </select>\n              </div>\n            </div>\n          </div>\n        </td>\n        <td>\n          <div class="field has-addons">\n            <div class="control">\n              <span class="button is-static">\n              <span class="icon">\n                <i class="fas ${l.isAdmin?t:a}" aria-hidden="true"></i>\n              </span>\n              </span>\n            </div>\n            <div class="control is-expanded">\n              <div class="select is-fullwidth">\n                <select data-action="doUpdateUserIsAdmin">\n                  <option value="0">No Admin Permissions</option>\n                  <option value="1" ${l.isAdmin?" selected":""}>Administrator</option>\n                </select>\n              </div>\n            </div>\n          </div>\n        </td>\n        <td>\n          <button class="button is-light is-danger is-delete-button" type="button" aria-label="Delete User">\n            <i class="fas fa-trash" aria-hidden="true"></i>\n          </button>\n        </td>`,null===(e=i.querySelector(".is-delete-button"))||void 0===e||e.addEventListener("click",o),null===(s=n.querySelector("tbody"))||void 0===s||s.append(i)}const d=n.querySelectorAll("select");for(const e of d)e.addEventListener("change",l)}null===(e=document.querySelector(".is-add-user-button"))||void 0===e||e.addEventListener("click",()=>{let e;function t(n){n.preventDefault(),cityssm.postJSON(`${s.urlPrefix}/admin/doAddUser`,n.currentTarget,s=>{const n=s;n.success?(i=n.users,e(),bulmaJS.alert({message:"User added successfully.",contextualColorName:"success"}),d()):bulmaJS.alert({title:"Error Adding User",message:"Please try again.",contextualColorName:"danger"})})}cityssm.openHtmlModal("user-add",{onshow(e){e.querySelector('[data-field="userDomain"]').textContent=n},onshown(s,n){var a;bulmaJS.toggleHtmlClipped(),e=n,null===(a=s.querySelector("form"))||void 0===a||a.addEventListener("submit",t)},onremoved(){bulmaJS.toggleHtmlClipped()}})}),d()})();