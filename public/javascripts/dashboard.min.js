"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=exports.Emile,a=document.querySelector("#container--dashboard"),t=document.querySelector("#form--dashboard"),n=t.querySelector("#dashboard--startDateString"),s=t.querySelector("#dashboard--endDateString");let i={};function d(e,a){return`${e}_${a}`}function l(e){return new Date(1e3*e).toLocaleString()}function r(e,a,t){e.data.labels.push(a);for(const a of e.data.datasets)a.data.push(t)}function o(e,a){var t,n,s,i,d;const r=document.createElement("tr");r.innerHTML=`<td>${l(a.timeSeconds)}</td>\n      <td>${function(e){let a=e,t="s";return a>=60?(t="min",(a/=60)>=60?(t="hr",(a/=60)>=24&&(a/=24,t="days"),`${a} ${t}`):`${a} ${t}`):`${a} ${t}`}(a.durationSeconds)}</td>\n      <td>${null!==(t=a.readingType)&&void 0!==t?t:""}</td>\n      <td>${null!==(n=a.commodity)&&void 0!==n?n:""}</td>\n      <td class="has-text-right">${a.dataValue}</td>\n      <td>${null!==(s=a.powerOfTenMultiplierName)&&void 0!==s?s:""}</td>\n      <td>${null!==(i=a.unit)&&void 0!==i?i:""}</td>`,null===(d=e.querySelector("tbody"))||void 0===d||d.append(r)}function c(){n.value>s.value?a.innerHTML='<div class="message is-warning">\n        <p class="message-body">The start date must be less than or equal to the end date.</p>\n        </div>':(a.innerHTML='<p class="has-text-centered has-text-grey">\n      <i class="fas fa-pulse fa-spinner fa-4x" aria-hidden="true"></i><br />\n      Loading data...\n      </p>',cityssm.postJSON(`${e.urlPrefix}/dashboard/doGetEnergyData`,t,t=>{var n,s,c;const h=t;a.innerHTML="",i={},0===h.energyData.length&&(a.innerHTML='<div class="message is-info">\n            <p class="message-body">There is no energy data that meets your search criteria.</p>\n            </div>');for(const e of h.energyData){const t=d(e.assetId,e.dataTypeId);if(void 0===i[t]){const d=document.createElement("div");d.className="panel",d.innerHTML=`<div class="panel-heading">\n              <div class="level is-mobile">\n                <div class="level-left">\n                  <div class="level-item">\n                    <i class="${null!==(n=e.fontAwesomeIconClasses)&&void 0!==n?n:"fas fa-bolt"}" aria-hidden="true"></i>\n                  </div>\n                  <div class="level-item is-block">\n                    <h2 class="has-text-weight-bold" data-field="assetName"></h2>\n                    <span class="has-text-weight-normal" data-field="serviceCategory"></span>\n                  </div>\n                </div>\n                <div class="level-right">\n                  <div class="level-item">\n                    <div class="tabs is-toggle is-toggle-rounded has-text-weight-normal">\n                      <ul role="presentation">\n                        <li class="is-active">\n                          <a href="#chartTab_${t}">\n                            <span class="icon is-small"><i class="fas fa-chart-bar" aria-hidden="true"></i></span>\n                            <span>Chart</span>\n                          </a>\n                        </li>\n                        <li>\n                          <a href="#tableTab_${t}">\n                            <span class="icon is-small"><i class="fas fa-table" aria-hidden="true"></i></span>\n                            <span>Table</span>\n                          </a>\n                        </li>\n                      </ul>\n                    </div>\n                  </div>\n                  <div class="level-item">\n                    <a class="button is-export-link" download>\n                      <span class="icon is-small"><i class="fas fa-file-csv" aria-hidden="true"></i></span>\n                      <span class="has-text-weight-normal">Export</span>\n                    </a>\n                  </div>\n                </div>\n              </div>\n              </div>\n              <div class="tabs-container panel-block is-block">\n                <div id="chartTab_${t}">\n                  <canvas style="max-height:400px"></canvas>\n                </div>\n                <div id="tableTab_${t}" class="is-hidden">\n                  <table class="table is-fullwidth is-striped is-hoverable has-sticky-header">\n                    <thead>\n                      <tr>\n                        <th>Time</th>\n                        <th>Duration</th>\n                        <th>Reading Type</th>\n                        <th>Commodity</th>\n                        <th class="has-text-right">Value</th>\n                        <th colspan="2">Unit</th>\n                      </tr>\n                    </thead>\n                    <tbody></tbody>\n                  </table>\n                </div>\n              </div>`,d.querySelector('[data-field="assetName"]').textContent=null!==(s=e.assetName)&&void 0!==s?s:"",d.querySelector('[data-field="serviceCategory"]').textContent=null!==(c=e.serviceCategory)&&void 0!==c?c:"",a.append(d);const r=new Chart(d.querySelector("canvas"),{type:"bar",data:{labels:[l(e.timeSeconds)],datasets:[{label:e.unit,data:[e.dataValue*Math.pow(10,e.powerOfTenMultiplier)]}]}}),h=d.querySelector("table");i[t]={chart:r,table:h,exportLink:a.querySelector(".is-export-link"),assetId:e.assetId,dataTypeId:e.dataTypeId,timeSecondsMin:e.timeSeconds,timeSecondsMax:e.timeSeconds},o(h,e)}else r(i[t].chart,l(e.timeSeconds),e.dataValue*Math.pow(10,e.powerOfTenMultiplier)),o(i[t].table,e),i[t].timeSecondsMin=Math.min(i[t].timeSecondsMin,e.timeSeconds),i[t].timeSecondsMax=Math.max(i[t].timeSecondsMax,e.timeSeconds)}for(const a of Object.values(i))a.chart.update(),a.exportLink.href=`${e.urlPrefix}/reports/energyData-formatted-filtered/?assetId=${a.assetId}&dataTypeId=${a.dataTypeId}&timeSecondsMin=${a.timeSecondsMin}&timeSecondsMax=${a.timeSecondsMax}`;bulmaJS.init(a)}))}e.initializeAssetSelector({assetSelectorElement:t.querySelector("#dashboard--assetSelector"),callbackFunction:c}),n.addEventListener("change",c),s.addEventListener("change",c),t.addEventListener("submit",e=>{e.preventDefault(),c()}),c()})();