"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e,a;const t=exports.Emile,n=document.querySelector("#container--dashboard"),s=document.querySelector("#form--dashboard");let i={};function l(e,a){return`${e}_${a}`}function d(e){return new Date(1e3*e).toLocaleString()}function r(e,a,t){e.data.labels.push(a);for(const a of e.data.datasets)a.data.push(t)}function o(e,a){var t,n,s,i;const l=document.createElement("tr");l.innerHTML=`<td>${d(a.timeSeconds)}</td>\n      <td>${null!==(t=a.readingType)&&void 0!==t?t:""}</td>\n      <td>${null!==(n=a.commodity)&&void 0!==n?n:""}</td>\n      <td class="has-text-right">${a.dataValue}</td>\n      <td>${null!==(s=a.unit)&&void 0!==s?s:""}</td>`,null===(i=e.querySelector("tbody"))||void 0===i||i.append(l)}function c(){n.innerHTML='<p class="has-text-centered has-text-grey">\n      <i class="fas fa-pulse fa-spinner fa-4x" aria-hidden="true"></i><br />\n      Loading data...\n      </p>',cityssm.postJSON(`${t.urlPrefix}/dashboard/doGetEnergyData`,s,e=>{var a,t,s;const c=e;n.innerHTML="",i={};for(const e of c.energyData){const c=l(e.assetId,e.dataTypeId);if(void 0===i[c]){const l=document.createElement("div");l.className="panel",l.innerHTML=`<div class="panel-heading">\n              <div class="level is-mobile">\n                <div class="level-left">\n                  <div class="level-item">\n                    <i class="${null!==(a=e.fontAwesomeIconClasses)&&void 0!==a?a:"fas fa-bolt"}" aria-hidden="true"></i>\n                  </div>\n                  <div class="level-item is-block">\n                    <h2 class="has-text-weight-bold" data-field="assetName"></h2>\n                    <span class="has-text-weight-normal" data-field="serviceCategory"></span>\n                  </div>\n                </div>\n                <div class="level-right">\n                  <div class="level-item">\n                    <div class="tabs is-toggle is-toggle-rounded">\n                      <ul>\n                        <li class="is-active">\n                          <a href="#chartTab_${c}">\n                            <span class="icon is-small"><i class="fas fa-chart-bar" aria-hidden="true"></i></span>\n                            <span>Chart</span>\n                          </a>\n                        </li>\n                        <li>\n                          <a href="#tableTab_${c}">\n                            <span class="icon is-small"><i class="fas fa-table" aria-hidden="true"></i></span>\n                            <span>Table</span>\n                          </a>\n                        </li>\n                      </ul>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              </div>\n              <div class="tabs-container panel-block is-block">\n                <div id="chartTab_${c}">\n                  <canvas style="max-height:400px"></canvas>\n                </div>\n                <div id="tableTab_${c}" class="is-hidden">\n                  <table class="table is-fullwidth is-striped is-hoverable has-sticky-header">\n                    <thead>\n                      <tr>\n                        <th>Time</th>\n                        <th>Reading Type</th>\n                        <th>Commodity</th>\n                        <th class="has-text-right">Value</th>\n                        <th>Unit</th>\n                      </tr>\n                    </thead>\n                    <tbody></tbody>\n                  </table>\n                </div>\n              </div>`,l.querySelector('[data-field="assetName"]').textContent=null!==(t=e.assetName)&&void 0!==t?t:"",l.querySelector('[data-field="serviceCategory"]').textContent=null!==(s=e.serviceCategory)&&void 0!==s?s:"",n.append(l);const r=new Chart(l.querySelector("canvas"),{type:"bar",data:{labels:[d(e.timeSeconds)],datasets:[{label:e.unit,data:[e.dataValue*Math.pow(10,e.powerOfTenMultiplier)]}]}}),h=l.querySelector("table");i[c]={chart:r,table:h},o(h,e)}else r(i[c].chart,d(e.timeSeconds),e.dataValue*Math.pow(10,e.powerOfTenMultiplier)),o(i[c].table,e)}for(const e of Object.values(i))e.chart.update();bulmaJS.init(n)})}t.initializeAssetSelector({assetSelectorElement:s.querySelector("#dashboard--assetSelector"),callbackFunction:c}),null===(e=s.querySelector("#dashboard--startDateString"))||void 0===e||e.addEventListener("change",c),null===(a=s.querySelector("#dashboard--endDateString"))||void 0===a||a.addEventListener("change",c),s.addEventListener("submit",e=>{e.preventDefault(),c()}),c()})();